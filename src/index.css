@tailwind base;
@tailwind components;
@tailwind utilities;

/* Prevent horizontal scroll and ensure proper centering */
html, body {
  overflow-x: hidden;
  width: 100%;
  scroll-behavior: smooth;
}

/* Definition of the design system. All colors, gradients, fonts, etc should be defined here. 
All colors MUST be HSL.
Enhanced Moroccan Heritage Design System
*/

@layer base {
  :root {
    /* === BNRM OFFICIAL COLOR PALETTE === */
    /* Based on official brand guidelines - Slate, Blue, Amber families */
    
    /* Slate Family - Neutral surfaces */
    --slate-surface: 210 40% 98%; /* #F8FAFC */
    --slate-light: 214 32% 96%; /* #F1F5F9 */
    --slate-border: 214 32% 91%; /* #E2E8F0 */
    --slate-text-light: 215 16% 65%; /* #94A3B8 */
    --slate-text: 215 20% 47%; /* #64748B */
    --slate-base: 217 23% 27%; /* #334155 */
    --slate-base-dark: 217 33% 17%; /* #1E293B */
    
    /* Blue Family - Primary brand colors */
    --blue-surface: 214 100% 97%; /* #EFF6FF */
    --blue-light: 214 95% 93%; /* #DBEAFE */
    --blue-soft: 213 94% 78%; /* #93C5FD */
    --blue-primary: 223 71% 40%; /* #1E40AF - Official BNRM Blue */
    --blue-primary-dark: 223 71% 35%; /* Darker variant */
    --blue-deep: 223 71% 30%; /* Deep variant */
    --blue-dark: 223 71% 25%; /* Dark variant */
    
    /* Amber Family - Accent colors */
    --amber-surface: 48 100% 95%; /* #FFFBE9 */
    --amber-light: 48 96% 89%; /* #FEF3C7 */
    --amber-soft: 45 96% 64%; /* #FCD34D */
    --amber-primary: 43 96% 50%; /* #F59E0B */
    --amber-primary-dark: 32 95% 44%; /* #D97706 */
    --amber-deep: 27 91% 37%; /* #B45309 */
    --amber-dark: 25 81% 26%; /* #78350F */
    
    /* Semantic tokens mapped to BNRM palette */
    --background: var(--slate-surface);
    --foreground: var(--slate-base-dark);

    --card: var(--slate-light);
    --card-foreground: var(--slate-base-dark);

    --popover: var(--slate-light);
    --popover-foreground: var(--slate-base-dark);

    /* Primary: Official BNRM Blue */
    --primary: var(--blue-primary);
    --primary-foreground: 0 0% 100%;
    --primary-glow: var(--blue-soft);
    --primary-deep: var(--blue-deep);

    /* Secondary: Amber tones for warmth */
    --secondary: var(--amber-light);
    --secondary-foreground: var(--slate-base-dark);
    --secondary-warm: var(--amber-soft);

    /* Muted: Slate neutral tones */
    --muted: var(--slate-light);
    --muted-foreground: var(--slate-text);

    /* Accent: Amber for emphasis */
    --accent: var(--amber-primary);
    --accent-foreground: 0 0% 100%;
    --accent-glow: var(--amber-soft);
    --accent-bright: var(--amber-primary-dark);

    /* Highlight: Deep amber */
    --highlight: var(--amber-deep);
    --highlight-foreground: 0 0% 100%;
    --highlight-deep: var(--amber-dark);

    /* Gold: Legacy support - mapped to amber */
    --gold: var(--amber-soft);
    --gold-foreground: var(--slate-base-dark);
    --gold-bright: var(--amber-primary);

    /* Coral: Legacy support - mapped to amber */
    --coral: var(--amber-primary);
    --coral-foreground: 0 0% 100%;

    /* Royal: Legacy support - mapped to blue */
    --royal: var(--blue-primary-dark);
    --royal-foreground: 0 0% 100%;

    /* === CBM Portal Specific Colors === */
    /* Palette distinctive pour le Catalogue des Bibliothèques Marocaines */
    --cbm-primary: 210 85% 45%; /* Bleu bibliothèque */
    --cbm-primary-foreground: 0 0% 100%;
    --cbm-primary-light: 210 75% 55%;
    --cbm-primary-dark: 210 90% 35%;
    
    --cbm-secondary: 160 70% 40%; /* Vert émeraude réseau */
    --cbm-secondary-foreground: 0 0% 100%;
    --cbm-secondary-light: 160 60% 50%;
    
    --cbm-accent: 180 65% 50%; /* Turquoise interactif */
    --cbm-accent-foreground: 0 0% 100%;
    --cbm-accent-glow: 180 55% 60%;
    
    --cbm-neutral: 210 15% 30%; /* Gris ardoise */
    --cbm-neutral-foreground: 0 0% 100%;
    --cbm-neutral-light: 210 10% 85%;
    
    /* Gradients CBM */
    --gradient-cbm: linear-gradient(135deg, hsl(var(--cbm-primary)), hsl(var(--cbm-secondary)), hsl(var(--cbm-accent)));
    --gradient-cbm-subtle: linear-gradient(180deg, hsl(var(--cbm-primary) / 0.05), hsl(var(--cbm-secondary) / 0.05));
    
    /* Patterns CBM - Hexagones et réseaux */
    --pattern-cbm-network: 
      repeating-linear-gradient(60deg, hsl(var(--cbm-primary) / 0.06) 0px, hsl(var(--cbm-primary) / 0.06) 1px, transparent 1px, transparent 40px),
      repeating-linear-gradient(120deg, hsl(var(--cbm-secondary) / 0.05) 0px, hsl(var(--cbm-secondary) / 0.05) 1px, transparent 1px, transparent 40px),
      repeating-linear-gradient(0deg, hsl(var(--cbm-accent) / 0.04) 0px, hsl(var(--cbm-accent) / 0.04) 1px, transparent 1px, transparent 40px);
    
    /* Ombres CBM */
    --shadow-cbm: 0 4px 20px -4px hsl(var(--cbm-primary) / 0.2), 0 2px 8px -2px hsl(var(--cbm-secondary) / 0.1);
    --shadow-cbm-strong: 0 8px 32px -8px hsl(var(--cbm-primary) / 0.3), 0 4px 12px -2px hsl(var(--cbm-accent) / 0.15);

    /* === Kitab Platform Specific Colors === */
    /* Palette distinctive pour la plateforme éditoriale Kitab */
    --kitab-primary: 25 85% 50%; /* Orange éditorial */
    --kitab-primary-foreground: 0 0% 100%;
    --kitab-primary-light: 25 75% 60%;
    --kitab-primary-dark: 25 90% 40%;
    
    --kitab-secondary: 280 70% 50%; /* Violet créatif */
    --kitab-secondary-foreground: 0 0% 100%;
    --kitab-secondary-light: 280 60% 60%;
    
    --kitab-accent: 340 80% 55%; /* Rose vif */
    --kitab-accent-foreground: 0 0% 100%;
    --kitab-accent-glow: 340 70% 65%;
    
    --kitab-neutral: 30 10% 30%; /* Brun neutre */
    --kitab-neutral-foreground: 0 0% 100%;
    --kitab-neutral-light: 30 8% 90%;
    
    /* Gradients Kitab */
    --gradient-kitab: linear-gradient(135deg, hsl(var(--kitab-primary)), hsl(var(--kitab-secondary)), hsl(var(--kitab-accent)));
    --gradient-kitab-subtle: linear-gradient(180deg, hsl(var(--kitab-primary) / 0.05), hsl(var(--kitab-accent) / 0.05));
    
    /* Patterns Kitab - Livres et publications */
    --pattern-kitab-books: 
      repeating-linear-gradient(45deg, hsl(var(--kitab-primary) / 0.05) 0px, hsl(var(--kitab-primary) / 0.05) 10px, transparent 10px, transparent 20px),
      repeating-linear-gradient(-45deg, hsl(var(--kitab-secondary) / 0.04) 0px, hsl(var(--kitab-secondary) / 0.04) 10px, transparent 10px, transparent 20px),
      repeating-linear-gradient(90deg, hsl(var(--kitab-accent) / 0.03) 0px, hsl(var(--kitab-accent) / 0.03) 1px, transparent 1px, transparent 30px);
    
    /* Ombres Kitab */
    --shadow-kitab: 0 4px 20px -4px hsl(var(--kitab-primary) / 0.25), 0 2px 8px -2px hsl(var(--kitab-accent) / 0.15);
    --shadow-kitab-strong: 0 8px 32px -8px hsl(var(--kitab-primary) / 0.35), 0 4px 12px -2px hsl(var(--kitab-secondary) / 0.2);

    --destructive: 0 70% 50%;
    --destructive-foreground: 0 0% 100%;

    --border: var(--slate-border);
    --input: var(--slate-light);
    --ring: var(--blue-primary);

    /* BNRM Official Gradients - Blue & Amber combinations */
    --gradient-primary: linear-gradient(135deg, hsl(var(--blue-primary)), hsl(var(--blue-soft)), hsl(var(--blue-light)));
    --gradient-accent: linear-gradient(135deg, hsl(var(--amber-primary)), hsl(var(--amber-soft)), hsl(var(--amber-light)));
    --gradient-neutral: linear-gradient(45deg, hsl(var(--slate-light)) 0%, hsl(var(--slate-surface)) 100%);
    --gradient-zellige-main: linear-gradient(60deg, hsl(var(--blue-primary)) 0%, hsl(var(--amber-primary)) 100%);
    --gradient-mosaique: linear-gradient(120deg, hsl(var(--slate-surface)) 0%, hsl(var(--blue-surface)) 50%, hsl(var(--amber-surface)) 100%);
    --gradient-subtle: linear-gradient(180deg, hsl(var(--background)), hsl(var(--slate-light)));
    
    /* Motifs Zellige Complexes et Raffinés */
    
    /* Zellige Mosaïques Traditionnelles */
    --pattern-zellige-complex: 
      radial-gradient(circle at 0% 50%, hsl(var(--primary) / 0.12) 8px, transparent 8px),
      radial-gradient(circle at 50% 0%, hsl(var(--accent) / 0.10) 6px, transparent 6px),
      radial-gradient(circle at 100% 50%, hsl(var(--gold) / 0.08) 8px, transparent 8px),
      radial-gradient(circle at 50% 100%, hsl(var(--secondary-warm) / 0.10) 6px, transparent 6px),
      radial-gradient(circle at 25% 25%, hsl(var(--highlight) / 0.06) 4px, transparent 4px),
      radial-gradient(circle at 75% 75%, hsl(var(--royal) / 0.08) 5px, transparent 5px),
      linear-gradient(45deg, hsl(var(--muted) / 0.15) 25%, transparent 25%),
      linear-gradient(-45deg, hsl(var(--card) / 0.12) 25%, transparent 25%);

    /* Mosaïque Géométrique Raffinée */
    --pattern-mosaique-geometric:
      repeating-linear-gradient(
        0deg,
        hsl(var(--primary) / 0.06) 0px,
        hsl(var(--primary) / 0.06) 1px,
        transparent 1px,
        transparent 16px
      ),
      repeating-linear-gradient(
        45deg,
        hsl(var(--accent) / 0.05) 0px,
        hsl(var(--accent) / 0.05) 1px,
        transparent 1px,
        transparent 12px
      ),
      repeating-linear-gradient(
        90deg,
        hsl(var(--gold) / 0.04) 0px,
        hsl(var(--gold) / 0.04) 1px,
        transparent 1px,
        transparent 20px
      ),
      repeating-linear-gradient(
        135deg,
        hsl(var(--secondary-warm) / 0.06) 0px,
        hsl(var(--secondary-warm) / 0.06) 1px,
        transparent 1px,
        transparent 14px
      );

    /* Motif Étoiles Marocaines */
    --pattern-moroccan-stars:
      radial-gradient(ellipse at center, hsl(var(--gold) / 0.08) 2px, transparent 2px),
      conic-gradient(from 0deg at 30% 30%, 
        hsl(var(--primary) / 0.04) 0deg,
        hsl(var(--accent) / 0.05) 60deg,
        hsl(var(--gold) / 0.04) 120deg,
        hsl(var(--secondary-warm) / 0.05) 180deg,
        hsl(var(--muted) / 0.04) 240deg,
        hsl(var(--card) / 0.05) 300deg,
        hsl(var(--primary) / 0.04) 360deg
      ),
      conic-gradient(from 45deg at 70% 70%, 
        hsl(var(--accent) / 0.04) 0deg,
        hsl(var(--gold) / 0.05) 72deg,
        hsl(var(--primary) / 0.04) 144deg,
        hsl(var(--secondary) / 0.05) 216deg,
        hsl(var(--muted) / 0.04) 288deg,
        hsl(var(--accent) / 0.04) 360deg
      );

    /* Carreaux Zellige */
    --pattern-zellige-tiles:
      repeating-conic-gradient(
        from 0deg at 25% 25%,
        hsl(var(--primary) / 0.08) 0deg 30deg,
        hsl(var(--accent) / 0.06) 30deg 60deg,
        hsl(var(--gold) / 0.05) 60deg 90deg,
        transparent 90deg 120deg
      ),
      repeating-conic-gradient(
        from 45deg at 75% 75%,
        hsl(var(--secondary-warm) / 0.07) 0deg 45deg,
        hsl(var(--muted) / 0.05) 45deg 90deg,
        transparent 90deg 135deg
      );

    /* Filigrane Marocain */
    --pattern-filigrane:
      radial-gradient(circle at 20% 80%, hsl(var(--gold) / 0.06) 15%, transparent 16%),
      radial-gradient(circle at 80% 20%, hsl(var(--primary) / 0.05) 15%, transparent 16%),
      radial-gradient(circle at 40% 40%, hsl(var(--accent) / 0.04) 10%, transparent 11%),
      linear-gradient(45deg, hsl(var(--secondary) / 0.08) 50%, transparent 50%);
    
    /* Ombres Minimalistes - Style filaire */
    --shadow-light: 0 1px 2px 0 hsl(0 0% 0% / 0.05);
    --shadow-sm: 0 1px 3px 0 hsl(0 0% 0% / 0.1), 0 1px 2px -1px hsl(0 0% 0% / 0.1);
    --shadow-base: 0 2px 4px -1px hsl(0 0% 0% / 0.1), 0 1px 3px -1px hsl(0 0% 0% / 0.1);
    --shadow-md: 0 4px 6px -1px hsl(0 0% 0% / 0.1), 0 2px 4px -2px hsl(0 0% 0% / 0.1);
    
    /* Ombres héritées conservées pour compatibilité */
    --shadow-moroccan: var(--shadow-md);
    --shadow-gold: var(--shadow-sm);
    --shadow-elegant: var(--shadow-base);
    --shadow-berber: var(--shadow-base);
    --shadow-zellige: var(--shadow-sm);
    --shadow-royal: var(--shadow-base);
    --shadow-mosaique: var(--shadow-md);

    --radius: 0.5rem;

    --sidebar-background: 0 0% 98%;

    --sidebar-foreground: 240 5.3% 26.1%;

    --sidebar-primary: 240 5.9% 10%;

    --sidebar-primary-foreground: 0 0% 98%;

    --sidebar-accent: 240 4.8% 95.9%;

    --sidebar-accent-foreground: 240 5.9% 10%;

    --sidebar-border: 220 13% 91%;

    --sidebar-ring: 217.2 91.2% 59.8%;
  }

  .dark {
    /* Dark mode with BNRM official palette */
    --background: var(--slate-base-dark);
    --foreground: var(--slate-surface);

    --card: var(--slate-base);
    --card-foreground: var(--slate-surface);

    --popover: var(--slate-base);
    --popover-foreground: var(--slate-surface);

    --primary: var(--blue-soft);
    --primary-foreground: var(--slate-base-dark);
    --primary-glow: var(--blue-light);

    --secondary: var(--slate-base);
    --secondary-foreground: var(--slate-surface);

    --muted: var(--slate-base);
    --muted-foreground: var(--slate-text-light);

    --accent: var(--amber-soft);
    --accent-foreground: var(--slate-base-dark);
    --accent-glow: var(--amber-light);

    --highlight: var(--amber-primary);
    --highlight-foreground: var(--slate-base-dark);

    --gold: var(--amber-soft);
    --gold-foreground: var(--slate-base-dark);

    --destructive: 0 60% 55%;
    --destructive-foreground: 0 0% 100%;

    --border: var(--slate-text);
    --input: var(--slate-base);
    --ring: var(--blue-soft);
    --sidebar-background: 240 5.9% 10%;
    --sidebar-foreground: 240 4.8% 95.9%;
    --sidebar-primary: 224.3 76.3% 48%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 240 3.7% 15.9%;
    --sidebar-accent-foreground: 240 4.8% 95.9%;
    --sidebar-border: 240 3.7% 15.9%;
    --sidebar-ring: 217.2 91.2% 59.8%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    font-feature-settings: 'liga', 'kern';
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Enhanced animations with Moroccan flair */
  .animate-glow {
    animation: glow 2s ease-in-out infinite alternate;
  }

  @keyframes glow {
    from {
      box-shadow: 0 4px 20px -4px hsl(var(--accent) / 0.15);
    }
    to {
      box-shadow: 0 8px 32px -8px hsl(var(--gold) / 0.3), 0 4px 20px -4px hsl(var(--accent) / 0.25);
    }
  }

  /* BNRM Official Typography - Improved text rendering */
  .font-arabic {
    font-family: 'Amiri', 'Noto Naskh Arabic', 'Noto Sans Arabic', 'Arial Unicode MS', serif;
    font-feature-settings: 'calt' 1, 'liga' 1, 'dlig' 1;
  }

  .font-french {
    font-family: 'Georgia', 'Times New Roman', serif;
    font-feature-settings: 'liga' 1, 'kern' 1;
  }

  .font-berber {
    font-family: 'Noto Sans Tifinagh', 'Arial Unicode MS', sans-serif;
  }

  /* BNRM Official Icons - Material Symbols */
  .material-symbols-outlined {
    font-family: 'Material Symbols Outlined';
    font-weight: normal;
    font-style: normal;
    font-size: 24px;
    line-height: 1;
    letter-spacing: normal;
    text-transform: none;
    display: inline-block;
    white-space: nowrap;
    word-wrap: normal;
    direction: ltr;
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizeLegibility;
    -moz-osx-font-smoothing: grayscale;
    font-feature-settings: 'liga';
  }

  /* Icon variants following BNRM guidelines */
  .icon-interactive {
    color: hsl(var(--blue-primary)); /* #3B82F6 - Official interactive color */
  }

  .icon-sm { font-size: 18px; }
  .icon-md { font-size: 24px; }
  .icon-lg { font-size: 32px; }
  .icon-xl { font-size: 48px; }

  /* Form sections styling - loc.gov inspired */
  .form-section {
    @apply mb-8 last:mb-0;
  }

  .form-section-title {
    @apply text-lg font-bold text-primary mb-4 pb-2 border-b border-primary/20 flex items-center gap-2;
  }

  .form-field-group {
    @apply space-y-4 mb-5;
  }

  .form-container {
    @apply max-w-4xl mx-auto bg-background p-6 sm:p-8;
  }

  .form-card {
    @apply bg-card rounded-lg border border-border shadow-sm p-4 sm:p-6;
  }

  /* Grille uniforme et espacements cohérents */
  .grid-responsive {
    @apply grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4;
  }

  .grid-responsive-2 {
    @apply grid grid-cols-1 md:grid-cols-2 gap-4;
  }

  .spacing-section {
    @apply space-y-6;
  }

  .spacing-content {
    @apply space-y-4;
  }

  .spacing-compact {
    @apply space-y-2;
  }

  /* Accessibility styles */
  :root {
    --font-size-multiplier: 1;
    --letter-spacing: 0px;
    --word-spacing: 0px;
    --line-height-add: 0;
    --cursor-size: 1;
    
    /* Z-index system - Gestion unifiée des couches */
    --z-base: 0;
    --z-dropdown: 100;
    --z-sticky: 200;
    --z-navbar: 300;
    --z-fixed: 400;
    --z-modal-backdrop: 500;
    --z-modal: 600;
    --z-popover: 700;
    --z-tooltip: 800;
    --z-notification: 900;
    --z-overlay: 60;
    --z-dialog: 61;
    
    /* Compatibilité ancienne nomenclature */
    --z-dialog-overlay: var(--z-overlay);
    --z-dialog-content: var(--z-dialog);
    --z-sheet-overlay: var(--z-overlay);
    --z-sheet-content: var(--z-dialog);
    
    /* BNRM Messaging Tokens */
    --bnrm-bg: 40 15% 97%; /* #F8F7F2 */
    --bnrm-border: 40 10% 91%; /* #E7E5DF */
    --bnrm-accent: 42 35% 60%; /* #C6A760 */
    --bnrm-accent-foreground: 0 0% 100%;
    --bnrm-text: 0 0% 20%; /* #333333 */
    --bnrm-muted: 0 0% 40%; /* #666666 */
    --bnrm-bubble-own: 0 0% 100%;
    --bnrm-bubble-other: 40 10% 95%;
    --bnrm-timestamp: 0 0% 54%; /* #8A8A8A */
  }

  /* Accessibility: font size, spacing, and line height adjustments */
  body.accessibility-enabled * {
    font-size: calc(1em * var(--font-size-multiplier, 1));
    letter-spacing: calc(var(--letter-spacing, 0px));
    word-spacing: calc(var(--word-spacing, 0px));
    line-height: calc(1.5 + var(--line-height-add, 0));
  }

  /* Accessibility: contrast modes */
  body.contrast-light,
  body.contrast-light * {
    filter: grayscale(0.5) contrast(0.8) brightness(1.2);
  }

  body.contrast-dark,
  body.contrast-dark * {
    filter: grayscale(1) contrast(2) brightness(0.8);
  }

  /* Fixed chat window that stays on top during scroll */
  .fixed-chat {
    position: fixed;
    z-index: var(--z-dialog);
    transform: translateZ(0);
    will-change: transform;
    backface-visibility: hidden;
    perspective: 1000px;
  }

  /* Wiggle animation for avatar */
  @keyframes wiggle {
    0%, 7% { transform: rotateZ(0deg); }
    15% { transform: rotateZ(-15deg); }
    20% { transform: rotateZ(10deg); }
    25% { transform: rotateZ(-10deg); }
    30% { transform: rotateZ(6deg); }
    35% { transform: rotateZ(-4deg); }
    40%, 100% { transform: rotateZ(0deg); }
  }

  .animate-wiggle {
    animation: wiggle 1.5s ease-in-out;
  }

  /* Modales et Dialogs - Radix UI centrage optimisé */
  
  /* Overlay global - Couvre tout l'écran avec z-index cohérent */
  [data-radix-dialog-overlay],
  [data-radix-alert-dialog-overlay],
  [data-radix-sheet-overlay] {
    position: fixed;
    inset: 0;
    background-color: hsl(0 0% 0% / 0.5);
    backdrop-filter: blur(2px);
    z-index: var(--z-overlay);
    animation: overlayShow 150ms cubic-bezier(0.16, 1, 0.3, 1);
  }

  @keyframes overlayShow {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  /* Content centré - Position fixed avec transform */
  [data-radix-dialog-content],
  [data-radix-alert-dialog-content] {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: var(--z-dialog);
    background: hsl(var(--background));
    border-radius: var(--radius);
    box-shadow: var(--shadow-md);
    max-width: min(90vw, 600px);
    max-height: 85vh;
    overflow-y: auto;
    padding: 1.5rem;
    animation: contentShow 150ms cubic-bezier(0.16, 1, 0.3, 1);
  }

  @keyframes contentShow {
    from {
      opacity: 0;
      transform: translate(-50%, -48%) scale(0.96);
    }
    to {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
    }
  }

  /* Sheet (sidebar) */
  [data-radix-sheet-content] {
    position: fixed;
    z-index: 9999;
    background: hsl(var(--background));
    box-shadow: var(--shadow-md);
  }

  /* Bloquer le scroll quand modal ouvert */
  body:has([data-radix-dialog-content]),
  body:has([data-radix-alert-dialog-content]),
  body:has([data-radix-sheet-content]) {
    overflow: hidden;
  }
}
